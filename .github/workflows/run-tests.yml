name: Run Tests
run-name: Build & Test Project Across 16+ Test Cases ðŸš€
on: [push]
jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Build project
      run: cargo build -r --verbose

    - name: Run Tests
      id: run_tests
      run: |
        result=$(cd tests && cargo run)
        echo "::set-output name=result::$result"

    - name: Parse test results
      run: |
        while IFS= read -r line; do
          if [[ $line == *"Passed!"* ]]; then
            echo "Test ${line#*#} - Passed"
          else
            echo "Test ${line#*#} - Failed"
            exit 1
          fi
        done <<< "${{ steps.run_tests.outputs.result }}"
